var __awaiter=this&&this.__awaiter||function(t,e,i,n){function o(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,s){function a(t){try{u(n.next(t))}catch(t){s(t)}}function r(t){try{u(n["throw"](t))}catch(t){s(t)}}function u(t){t.done?i(t.value):o(t.value).then(a,r)}u((n=n.apply(t,e||[])).next())}))};var __generator=this&&this.__generator||function(t,e){var i={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:r(0),throw:r(1),return:r(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function r(t){return function(e){return u([t,e])}}function u(a){if(n)throw new TypeError("Generator is already executing.");while(i)try{if(n=1,o&&(s=a[0]&2?o["return"]:a[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,a[1])).done)return s;if(o=0,s)a=[a[0]&2,s.value];switch(a[0]){case 0:case 1:s=a;break;case 4:i.label++;return{value:a[1],done:false};case 5:i.label++;o=a[1];a=[0];continue;case 7:a=i.ops.pop();i.trys.pop();continue;default:if(!(s=i.trys,s=s.length>0&&s[s.length-1])&&(a[0]===6||a[0]===2)){i=0;continue}if(a[0]===3&&(!s||a[1]>s[0]&&a[1]<s[3])){i.label=a[1];break}if(a[0]===6&&i.label<s[1]){i.label=s[1];s=a;break}if(s&&i.label<s[2]){i.label=s[2];i.ops.push(a);break}if(s[2])i.ops.pop();i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t];o=0}finally{n=s=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};System.register(["./p-eef094b0.system.js","./p-c66b9b83.system.js","./p-917f930c.system.js"],(function(t){"use strict";var e,i,n,o,s,a,r;return{setters:[function(t){e=t.r;i=t.c;n=t.h;o=t.H},function(t){s=t.a;a=t.E},function(t){r=t.i}],execute:function(){var u=":host{--ezp-theme-solid:var(--ezp-accent-cyan-solid);--ezp-theme-translucent:var(--ezp-accent-cyan-translucent);display:block}";var c=t("ezp_auth",function(){function t(t){e(this,t);this.authCancel=i(this,"authCancel",7);this.authSuccess=i(this,"authSuccess",7);this.oauthPopupWindow=null;this.previousUrl=null}t.prototype.listenDialogAction=function(){this.openSignInWindow(this.auth.authURI.toString(),"ezeep Login")};t.prototype.listenDialogClose=function(){this.authCancel.emit()};t.prototype.listenStatusCancel=function(){this.authCancel.emit()};t.prototype.openSignInWindow=function(t,e){var i=this;if(s.state.isAuthorized){this.authCancel.emit();this.authSuccess.emit();return}window.removeEventListener("message",this.receiveMessage);var n="toolbar=no, menubar=no, width=600, height=7000, top=100, left=100";if(this.oauthPopupWindow===null||this.oauthPopupWindow.closed){this.oauthPopupWindow=window.open(t,e,n)}else if(this.previousUrl!==this.auth.authURI.toString()){this.oauthPopupWindow=window.open(t,e,n);if(!this.oauthPopupWindow||this.oauthPopupWindow.closed||typeof this.oauthPopupWindow.closed=="undefined"){alert("popup blocked")}this.oauthPopupWindow.focus()}else{this.oauthPopupWindow.focus()}window.addEventListener("message",(function(t){return i.receiveMessage(t)}),false);this.previousUrl=this.auth.authURI};t.prototype.receiveMessage=function(t){var e=this;s.state.code=t.data;this.auth.getAccessToken().then((function(){e.authCancel.emit();e.authSuccess.emit()}))};t.prototype.componentWillLoad=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:this.auth=new a(this.redirectURI,this.clientID);if(!this.code)return[3,2];s.state.code=this.code;return[4,this.auth.getAccessToken()];case 1:t.sent();this.authCancel.emit();this.authSuccess.emit();t.label=2;case 2:if(!(s.state.isAuthorized===false))return[3,4];this.auth.generateCodeVerifier();return[4,this.auth.generateCodeChallenge(s.state.codeVerifier)];case 3:t.sent();this.auth.buildAuthURI();t.label=4;case 4:if(this.hidelogin&&this.trigger==="button"){this.openSignInWindow(this.auth.authURI.toString(),"ezeep Login")}return[2]}}))}))};t.prototype.render=function(){var t=this;return n(o,null,this.hidelogin&&this.trigger==="button"?n("ezp-status",{description:r.t("login_dialog.action"),processing:true,cancel:true}):this.hidelogin&&this.trigger==="file"?n("ezp-text-button",{type:"button",level:"primary",onClick:function(){return t.openSignInWindow(t.auth.authURI.toString(),"ezeep Login")},label:r.t("button_actions.select_printer")}):n("ezp-dialog",{heading:r.t("login_dialog.heading"),description:r.t("login_dialog.description"),action:r.t("login_dialog.action"),iconName:"logo",iconSize:"huge",iconFramed:false,instance:"login"}))};return t}());c.style=u}}}));